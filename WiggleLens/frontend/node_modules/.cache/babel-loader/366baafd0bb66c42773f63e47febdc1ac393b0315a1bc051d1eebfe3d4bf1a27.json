{"ast":null,"code":"import React,{useState,useEffect}from'react';import'./App.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function App(){const[image,setImage]=useState(null);const[fullImagePreview,setFullImagePreview]=useState(null);const[imagePreviews,setImagePreviews]=useState([]);const[imageSize,setImageSize]=useState({width:0,height:0});const[focalPoints,setFocalPoints]=useState([null,null,null]);const[error,setError]=useState(null);const[loading,setLoading]=useState(false);const[isSplit,setIsSplit]=useState(false);const[loadedImage,setLoadedImage]=useState(null);const[splitLoading,setSplitLoading]=useState(false);const[autoDetectLoading,setAutoDetectLoading]=useState(false);// NEW states for the next \"options\" screen\nconst[showWiggleOptions,setShowWiggleOptions]=useState(false);const[frameSpeed,setFrameSpeed]=useState(0.1);// 0.1 / 0.2 / 0.3\nconst[videoLength,setVideoLength]=useState(5);// 1..10 seconds slider\n// IMPORTANT: If useSecondFrameAsBackground is true, we'll call /api/process_image_no_rgba\n// Otherwise, we'll call /api/process_image\nconst[useSecondFrameAsBackground,setUseSecondFrameAsBackground]=useState(false);// We'll use this for our animated dots, starting at 1 (instead of 0).\nconst[processingDots,setProcessingDots]=useState(1);useEffect(()=>{let interval;if(loading){// Cycle through 1..3\ninterval=setInterval(()=>{setProcessingDots(prev=>{if(prev>=3){// If we're at 3, go back to 1\nreturn 1;}else{return prev+1;}});},600);}else{// Reset to 1 if not loading\nsetProcessingDots(1);}return()=>{if(interval)clearInterval(interval);};},[loading]);// Build dynamic text, e.g. \"Processing.\", \"Processing..\", \"Processing...\"\nconst processingText=\"Processing\".concat('.'.repeat(processingDots));// 1) Disable scrolling in website when at 100% zoom\nuseEffect(()=>{function checkZoom(){if(window.devicePixelRatio===1){// Hide scrollbars\ndocument.documentElement.style.overflow='hidden';}else{// Restore default scrolling\ndocument.documentElement.style.overflow='auto';}}checkZoom();window.addEventListener('resize',checkZoom);return()=>{window.removeEventListener('resize',checkZoom);};},[]);// 1) Utility function to rotate an HTMLImageElement by 90° and return a new File\n//    or data URL that you can use for preview/upload.\nconst rotateImage90=imgElement=>{return new Promise((resolve,reject)=>{try{// Because we rotate 90°, the new width = old height, new height = old width\nconst canvas=document.createElement('canvas');canvas.width=imgElement.height;canvas.height=imgElement.width;const ctx=canvas.getContext('2d');// Translate to (canvas.width, 0) then rotate 90° clockwise\nctx.translate(canvas.width,0);ctx.rotate(Math.PI/2);// Draw the image\nctx.drawImage(imgElement,0,0);ctx.resetTransform();// Option A: convert to Blob and then construct a new File\ncanvas.toBlob(blob=>{if(!blob){return reject(new Error('Canvas is empty, cannot rotate'));}// create a File from the Blob\nconst rotatedFile=new File([blob],'rotated_image.jpg',{type:'image/jpeg'});resolve(rotatedFile);},'image/jpeg',0.9);// Option B (alternative): directly get a data URL\n// const dataUrl = canvas.toDataURL('image/jpeg', 0.9);\n// resolve(dataUrl);\n}catch(err){reject(err);}});};const handleImageUpload=async e=>{const file=e.target.files[0];if(!file)return;// We'll load the raw File into an <img> for dimension checks\nconst img=new Image();img.onload=async()=>{const w=img.width;const h=img.height;const ratio=w/h;const epsilon=0.01;const isThreeTwo=Math.abs(ratio-1.5)<epsilon;// ~3:2\nconst isTwoThree=Math.abs(ratio-0.6667)<epsilon;// ~2:3\nif(!isThreeTwo&&!isTwoThree){setError('Please upload an image with a 3:2 or 2:3 aspect ratio.');e.target.value='';return;}setError(null);// If the image is ~2:3, rotate it 90° so that it becomes ~3:2\n// and store the rotated file.\nif(isTwoThree){try{const rotatedFile=await rotateImage90(img);setImage(rotatedFile);// Now load that rotatedFile into a new <img> to get updated preview & dimensions\nconst rotatedImg=new Image();rotatedImg.onload=()=>{setLoadedImage(rotatedImg);setFullImagePreview(rotatedImg.src);setImageSize({width:rotatedImg.width,height:rotatedImg.height});setShowWiggleOptions(false);};rotatedImg.onerror=()=>{setError('Failed to display rotated image.');};rotatedImg.src=URL.createObjectURL(rotatedFile);}catch(err){console.error('Rotation failed:',err);setError('Rotation failed');}}else{// It's ~3:2 already, no rotation needed\nsetImage(file);setLoadedImage(img);setFullImagePreview(img.src);setImageSize({width:w,height:h});setShowWiggleOptions(false);}setFocalPoints([null,null,null]);setIsSplit(false);};img.onerror=()=>{setError('Failed to load image.');e.target.value='';};img.src=URL.createObjectURL(file);};const handleSplitImage=async()=>{setFocalPoints([null,null,null]);setSplitLoading(true);try{const img=loadedImage;const sectionWidth=Math.floor(img.width/3);const sectionPromises=[0,1,2].map(async i=>{const canvas=new OffscreenCanvas(sectionWidth,img.height);const ctx=canvas.getContext('2d');ctx.drawImage(img,i*sectionWidth,0,sectionWidth,img.height,0,0,sectionWidth,img.height);const blob=await canvas.convertToBlob({type:'image/jpeg',quality:0.8});return URL.createObjectURL(blob);});const previews=await Promise.all(sectionPromises);setImagePreviews(previews);setIsSplit(true);}catch(err){console.error('Error splitting image:',err);setError('Failed to split image');}finally{setSplitLoading(false);}};const handleSectionClick=(sectionIndex,e)=>{const rect=e.target.getBoundingClientRect();const image=e.target;const renderedWidth=image.width;const renderedHeight=image.height;const scaleX=image.naturalWidth/renderedWidth;const scaleY=image.naturalHeight/renderedHeight;const imageAspect=image.naturalWidth/image.naturalHeight;const containerAspect=renderedWidth/renderedHeight;let x=e.clientX-rect.left;let y=e.clientY-rect.top;if(imageAspect>containerAspect){const actualHeight=renderedWidth/imageAspect;const padding=(renderedHeight-actualHeight)/2;y=y-padding;y=Math.max(0,Math.min(y,actualHeight));}else{const actualWidth=renderedHeight*imageAspect;const padding=(renderedWidth-actualWidth)/2;x=x-padding;x=Math.max(0,Math.min(x,actualWidth));}const originalX=Math.round(x*scaleX);const originalY=Math.round(y*scaleY);const sectionWidth=imageSize.width/3;const adjustedX=originalX+sectionIndex*sectionWidth;const finalX=Math.max(sectionIndex*sectionWidth,Math.min(adjustedX,(sectionIndex+1)*sectionWidth-1));const finalY=Math.max(0,Math.min(originalY,imageSize.height-1));const newFocalPoints=[...focalPoints];newFocalPoints[sectionIndex]={x:finalX,y:finalY};setFocalPoints(newFocalPoints);};// >>> UPDATED handleSubmit to call different endpoints based on 'useSecondFrameAsBackground' <<<\nconst handleSubmit=async e=>{e.preventDefault();if(focalPoints.some(fp=>fp===null)){setError('Please set a focal point on each section before creating wiggle.');return;}setError(null);setLoading(true);try{const formData=new FormData();formData.append('image',image);formData.append('focalPoints',JSON.stringify(focalPoints));formData.append('frameSpeed',frameSpeed);formData.append('videoLength',videoLength);formData.append('useSecondFrameAsBackground',useSecondFrameAsBackground.toString());// Decide which endpoint to call.\n// We do /api/process_image_no_rgba if useSecondFrameAsBackground is true,\n// otherwise /api/process_image.\nconst endpoint=useSecondFrameAsBackground?'http://localhost:5000/api/process_image_no_rgba':'http://localhost:5000/api/process_image';const response=await fetch(endpoint,{method:'POST',body:formData});if(!response.ok){const errorData=await response.json();throw new Error(errorData.error||'Failed to process image');}const blob=await response.blob();const url=window.URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='wiggle.mp4';document.body.appendChild(a);a.click();document.body.removeChild(a);window.URL.revokeObjectURL(url);}catch(err){setError(err.message);}finally{setLoading(false);}};function handleNext(){setShowWiggleOptions(true);}const handleBack=()=>{if(showWiggleOptions){setShowWiggleOptions(false);return;}if(isSplit){setIsSplit(false);}else if(image){setImage(null);setFullImagePreview(null);setImagePreviews([]);setFocalPoints([null,null,null]);}};const handleRotate180=async()=>{try{if(!loadedImage){setError('No image loaded.');return;}// Perform a 180° rotation by using a canvas exactly the same size\nconst canvas=document.createElement('canvas');canvas.width=loadedImage.width;canvas.height=loadedImage.height;const ctx=canvas.getContext('2d');// Move the origin to bottom-right, rotate by 180° (Math.PI)\nctx.translate(canvas.width,canvas.height);ctx.rotate(Math.PI);// Draw the original image at (0,0), which will appear rotated 180°\nctx.drawImage(loadedImage,0,0);ctx.resetTransform();// Convert to a Blob, and then a File\nconst blob=await new Promise((resolve,reject)=>{canvas.toBlob(b=>{if(!b)return reject(new Error('Canvas is empty, cannot rotate by 180.'));resolve(b);},'image/jpeg',0.9);});const rotatedFile=new File([blob],'rotated_180.jpg',{type:'image/jpeg'});// Create a new Image for preview\nconst rotatedImg=new Image();rotatedImg.onload=()=>{setLoadedImage(rotatedImg);setImage(rotatedFile);setFullImagePreview(rotatedImg.src);setImageSize({width:rotatedImg.width,height:rotatedImg.height});setError(null);};rotatedImg.onerror=()=>{setError('Failed to display 180°-rotated image.');};rotatedImg.src=URL.createObjectURL(rotatedFile);}catch(err){console.error('Rotation by 180° failed:',err);setError('Rotation by 180° failed.');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[(image||isSplit)&&/*#__PURE__*/_jsx(\"button\",{className:\"back-arrow\",onClick:handleBack,title:\"Go back\",children:\"\\u2190\"}),!image&&!isSplit&&/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',width:'100%',justifyContent:'center',alignItems:'center',padding:'40px 20px',boxSizing:'border-box'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{width:'50%',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"h1\",{style:{fontSize:'6em',marginBottom:'10px',color:'#5e645a',fontWeight:'bold',marginTop:'20%'},children:\"DispoStudio\"}),/*#__PURE__*/_jsx(\"h2\",{style:{fontSize:'2.5em',marginBottom:'10px',marginTop:'10px',color:'#5e645a',fontWeight:'normal'},children:\"Wiggle Lens Maker\"}),/*#__PURE__*/_jsxs(\"p\",{style:{lineHeight:'1.5',color:'#5e645a',marginTop:'20%',opacity:'60%',fontSize:'28px',margin:'20% 20%'},children:[\"Easily create wiggle lens effect videos with your\",/*#__PURE__*/_jsx(\"a\",{href:\"https://www.etsy.com/uk/shop/DispoStudio\",target:\"_blank\",rel:\"noopener noreferrer\",style:{color:'#5e645a',textDecoration:'underline',marginLeft:'5px',marginRight:'5px'},children:\"Swiss Army Lens\"}),\"photos in just a few clicks.\"]})]}),/*#__PURE__*/_jsx(\"div\",{style:{width:'50%'},children:/*#__PURE__*/_jsx(\"div\",{className:\"upload-container\",style:{textAlign:'center'},children:/*#__PURE__*/_jsxs(\"label\",{className:\"upload-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handleImageUpload,required:true,className:\"upload-input\"}),\"Upload Image\"]})})})]}),!showWiggleOptions&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"upload-form\",children:[fullImagePreview&&!isSplit&&/*#__PURE__*/_jsxs(\"div\",{className:\"full-image-container\",style:{display:'flex',gap:'20px'},children:[/*#__PURE__*/_jsx(\"img\",{src:fullImagePreview,alt:\"Full uploaded image\",className:\"full-image\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'row',alignItems:'center',justifyContent:'space-between',width:'90%',margin:'0 auto'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleRotate180,className:\"rotate-button\",style:{width:'45%',textAlign:'center',backgroundColor:'#5e645a'},children:\"Rotate 180\\xB0\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleSplitImage,className:\"split-button\",disabled:splitLoading,style:{width:'45%',textAlign:'center',backgroundColor:'#5e645a'},children:splitLoading?'Splitting...':'Split Image'})]})]}),isSplit&&imagePreviews.length>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"sections-container\",children:imagePreviews.map((preview,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"section-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"section-image-container\",children:[/*#__PURE__*/_jsx(\"img\",{src:preview,alt:\"Section \".concat(index+1),onClick:e=>handleSectionClick(index,e),className:\"section-image\"}),focalPoints[index]&&/*#__PURE__*/_jsx(\"div\",{className:\"focal-marker\",style:{left:\"\".concat((focalPoints[index].x-index*(imageSize.width/3))/(imageSize.width/3)*100,\"%\"),top:\"\".concat(focalPoints[index].y/imageSize.height*100,\"%\")}})]}),focalPoints[index]&&/*#__PURE__*/_jsx(\"div\",{className:\"coordinates-text\",children:\"Focal point: (\".concat(Math.round(focalPoints[index].x-index*(imageSize.width/3)),\", \").concat(Math.round(focalPoints[index].y),\")\")})]},index))}),focalPoints.some(fp=>fp===null)&&/*#__PURE__*/_jsx(\"h3\",{className:\"previews-title\",children:\"Click on each section to set focal points:\"})]}),isSplit&&!focalPoints.some(fp=>fp===null)&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"submit-button\",onClick:handleNext,children:\"Next\"})]}),showWiggleOptions&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"upload-form\",style:{marginTop:'5%',textAlign:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'40px',marginTop:'40px',textAlign:'center',width:'100%'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",disabled:true,className:\"split-button\",style:{backgroundColor:'#5e645a',cursor:'default',marginBottom:'20px',margin:'0 2%',width:'25%'},children:\"Frame Speed:\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'inline-block',margin:'0 2%',textAlign:'center',width:'20%'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 5px 0',color:'#5e645a'},children:\"0.1s\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"frame-button \".concat(frameSpeed===0.1?'selected-frame':''),onClick:()=>setFrameSpeed(0.1),children:\"Fast\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'inline-block',margin:'0 1%',textAlign:'center',width:'20%'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 5px 0',color:'#5e645a'},children:\"0.2s\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"frame-button \".concat(frameSpeed===0.2?'selected-frame':''),onClick:()=>setFrameSpeed(0.2),children:\"Medium\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'inline-block',margin:'0 1%',textAlign:'center',width:'20%'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 5px 0',color:'#5e645a'},children:\"0.3s\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"frame-button \".concat(frameSpeed===0.3?'selected-frame':''),onClick:()=>setFrameSpeed(0.3),children:\"Slow\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'40px',marginTop:'40px',textAlign:'center',width:'100%'},children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",disabled:true,className:\"split-button\",style:{backgroundColor:'#5e645a',cursor:'default',marginBottom:'20px',margin:'0 2%',width:'30%'},children:[\"Video Length: \",parseFloat(videoLength).toPrecision(2),\"s\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:\"1\",max:\"10\",value:videoLength,onChange:e=>setVideoLength(parseFloat(e.target.value)),step:(3*frameSpeed).toPrecision(1),className:\"video-slider\",defaultValue:5})]}),/*#__PURE__*/_jsxs(\"div\",{style:{margin:'30px 0',textAlign:'center',width:\"100%\"},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",disabled:true,className:\"split-button\",style:{backgroundColor:'#5e645a',cursor:'default',margin:'0 3%',width:'50%'},children:\"Cover background with frame 2:\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"split-button \".concat(useSecondFrameAsBackground?'selected-frame':''),style:{marginRight:'2%',width:'20%'},onClick:()=>setUseSecondFrameAsBackground(true),children:\"Yes\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"split-button \".concat(!useSecondFrameAsBackground?'selected-frame':''),style:{marginRight:'2%',width:'20%'},onClick:()=>setUseSecondFrameAsBackground(false),children:\"No\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"submit-button split-button\",style:{marginRight:'2%',width:'80%',textAlign:\"center\",marginTop:\"20%\"},children:loading?processingText:'Export Video'})]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"error-message\",children:[\"Error: \",error]})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","App","image","setImage","fullImagePreview","setFullImagePreview","imagePreviews","setImagePreviews","imageSize","setImageSize","width","height","focalPoints","setFocalPoints","error","setError","loading","setLoading","isSplit","setIsSplit","loadedImage","setLoadedImage","splitLoading","setSplitLoading","autoDetectLoading","setAutoDetectLoading","showWiggleOptions","setShowWiggleOptions","frameSpeed","setFrameSpeed","videoLength","setVideoLength","useSecondFrameAsBackground","setUseSecondFrameAsBackground","processingDots","setProcessingDots","interval","setInterval","prev","clearInterval","processingText","concat","repeat","checkZoom","window","devicePixelRatio","document","documentElement","style","overflow","addEventListener","removeEventListener","rotateImage90","imgElement","Promise","resolve","reject","canvas","createElement","ctx","getContext","translate","rotate","Math","PI","drawImage","resetTransform","toBlob","blob","Error","rotatedFile","File","type","err","handleImageUpload","e","file","target","files","img","Image","onload","w","h","ratio","epsilon","isThreeTwo","abs","isTwoThree","value","rotatedImg","src","onerror","URL","createObjectURL","console","handleSplitImage","sectionWidth","floor","sectionPromises","map","i","OffscreenCanvas","convertToBlob","quality","previews","all","handleSectionClick","sectionIndex","rect","getBoundingClientRect","renderedWidth","renderedHeight","scaleX","naturalWidth","scaleY","naturalHeight","imageAspect","containerAspect","x","clientX","left","y","clientY","top","actualHeight","padding","max","min","actualWidth","originalX","round","originalY","adjustedX","finalX","finalY","newFocalPoints","handleSubmit","preventDefault","some","fp","formData","FormData","append","JSON","stringify","toString","endpoint","response","fetch","method","body","ok","errorData","json","url","a","href","download","appendChild","click","removeChild","revokeObjectURL","message","handleNext","handleBack","handleRotate180","b","className","children","onClick","title","display","justifyContent","alignItems","boxSizing","textAlign","fontSize","marginBottom","color","fontWeight","marginTop","lineHeight","opacity","margin","rel","textDecoration","marginLeft","marginRight","accept","onChange","required","onSubmit","gap","alt","flexDirection","backgroundColor","disabled","length","preview","index","cursor","parseFloat","toPrecision","step","defaultValue"],"sources":["C:/Users/Leonidas/Desktop/Coding/DispoStudio/DispoWiggleLens/WiggleLens/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './App.css';\n\nfunction App() {\n  const [image, setImage] = useState(null);\n  const [fullImagePreview, setFullImagePreview] = useState(null);\n  const [imagePreviews, setImagePreviews] = useState([]);\n  const [imageSize, setImageSize] = useState({ width: 0, height: 0 });\n  const [focalPoints, setFocalPoints] = useState([null, null, null]);\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [isSplit, setIsSplit] = useState(false);\n  const [loadedImage, setLoadedImage] = useState(null);\n  const [splitLoading, setSplitLoading] = useState(false);\n  const [autoDetectLoading, setAutoDetectLoading] = useState(false);\n\n  // NEW states for the next \"options\" screen\n  const [showWiggleOptions, setShowWiggleOptions] = useState(false);\n  const [frameSpeed, setFrameSpeed] = useState(0.1);  // 0.1 / 0.2 / 0.3\n  const [videoLength, setVideoLength] = useState(5);  // 1..10 seconds slider\n  // IMPORTANT: If useSecondFrameAsBackground is true, we'll call /api/process_image_no_rgba\n  // Otherwise, we'll call /api/process_image\n  const [useSecondFrameAsBackground, setUseSecondFrameAsBackground] = useState(false);\n\n  // We'll use this for our animated dots, starting at 1 (instead of 0).\n  const [processingDots, setProcessingDots] = useState(1);\n\n  useEffect(() => {\n    let interval;\n    if (loading) {\n      // Cycle through 1..3\n      interval = setInterval(() => {\n        setProcessingDots((prev) => {\n          if (prev >= 3) {\n            // If we're at 3, go back to 1\n            return 1;\n          } else {\n            return prev + 1;\n          }\n        });\n      }, 600);\n    } else {\n      // Reset to 1 if not loading\n      setProcessingDots(1);\n    }\n\n    return () => {\n      if (interval) clearInterval(interval);\n    };\n  }, [loading]);\n\n  // Build dynamic text, e.g. \"Processing.\", \"Processing..\", \"Processing...\"\n  const processingText = `Processing${'.'.repeat(processingDots)}`;\n\n  // 1) Disable scrolling in website when at 100% zoom\n  useEffect(() => {\n    function checkZoom() {\n      if (window.devicePixelRatio === 1) {\n        // Hide scrollbars\n        document.documentElement.style.overflow = 'hidden';\n      } else {\n        // Restore default scrolling\n        document.documentElement.style.overflow = 'auto';\n      }\n    }\n    checkZoom();\n\n    window.addEventListener('resize', checkZoom);\n    return () => {\n      window.removeEventListener('resize', checkZoom);\n    };\n  }, []);\n\n  // 1) Utility function to rotate an HTMLImageElement by 90° and return a new File\n  //    or data URL that you can use for preview/upload.\n  const rotateImage90 = (imgElement) => {\n    return new Promise((resolve, reject) => {\n      try {\n        // Because we rotate 90°, the new width = old height, new height = old width\n        const canvas = document.createElement('canvas');\n        canvas.width = imgElement.height;\n        canvas.height = imgElement.width;\n\n        const ctx = canvas.getContext('2d');\n        // Translate to (canvas.width, 0) then rotate 90° clockwise\n        ctx.translate(canvas.width, 0);\n        ctx.rotate(Math.PI / 2);\n        // Draw the image\n        ctx.drawImage(imgElement, 0, 0);\n        ctx.resetTransform();\n\n        // Option A: convert to Blob and then construct a new File\n        canvas.toBlob((blob) => {\n          if (!blob) {\n            return reject(new Error('Canvas is empty, cannot rotate'));\n          }\n          // create a File from the Blob\n          const rotatedFile = new File([blob], 'rotated_image.jpg', { type: 'image/jpeg' });\n          resolve(rotatedFile);\n        }, 'image/jpeg', 0.9);\n\n        // Option B (alternative): directly get a data URL\n        // const dataUrl = canvas.toDataURL('image/jpeg', 0.9);\n        // resolve(dataUrl);\n      } catch (err) {\n        reject(err);\n      }\n    });\n  };\n\n  const handleImageUpload = async (e) => {\n    const file = e.target.files[0];\n    if (!file) return;\n\n    // We'll load the raw File into an <img> for dimension checks\n    const img = new Image();\n    img.onload = async () => {\n      const w = img.width;\n      const h = img.height;\n      const ratio = w / h;\n      const epsilon = 0.01;\n\n      const isThreeTwo = Math.abs(ratio - 1.5) < epsilon;   // ~3:2\n      const isTwoThree = Math.abs(ratio - 0.6667) < epsilon; // ~2:3\n\n      if (!isThreeTwo && !isTwoThree) {\n        setError('Please upload an image with a 3:2 or 2:3 aspect ratio.');\n        e.target.value = '';\n        return;\n      }\n\n      setError(null);\n\n      // If the image is ~2:3, rotate it 90° so that it becomes ~3:2\n      // and store the rotated file.\n      if (isTwoThree) {\n        try {\n          const rotatedFile = await rotateImage90(img);\n          setImage(rotatedFile);\n\n          // Now load that rotatedFile into a new <img> to get updated preview & dimensions\n          const rotatedImg = new Image();\n          rotatedImg.onload = () => {\n            setLoadedImage(rotatedImg);\n            setFullImagePreview(rotatedImg.src);\n            setImageSize({ width: rotatedImg.width, height: rotatedImg.height });\n            setShowWiggleOptions(false);\n          };\n          rotatedImg.onerror = () => {\n            setError('Failed to display rotated image.');\n          };\n          rotatedImg.src = URL.createObjectURL(rotatedFile);\n        } catch (err) {\n          console.error('Rotation failed:', err);\n          setError('Rotation failed');\n        }\n      } else {\n        // It's ~3:2 already, no rotation needed\n        setImage(file);\n        setLoadedImage(img);\n        setFullImagePreview(img.src);\n        setImageSize({ width: w, height: h });\n        setShowWiggleOptions(false);\n      }\n\n      setFocalPoints([null, null, null]);\n      setIsSplit(false);\n    };\n\n    img.onerror = () => {\n      setError('Failed to load image.');\n      e.target.value = '';\n    };\n\n    img.src = URL.createObjectURL(file);\n  };\n\n  const handleSplitImage = async () => {\n    setFocalPoints([null, null, null]);\n    setSplitLoading(true);\n\n    try {\n      const img = loadedImage;\n      const sectionWidth = Math.floor(img.width / 3);\n\n      const sectionPromises = [0, 1, 2].map(async (i) => {\n        const canvas = new OffscreenCanvas(sectionWidth, img.height);\n        const ctx = canvas.getContext('2d');\n        \n        ctx.drawImage(img, i * sectionWidth, 0, sectionWidth, img.height, 0, 0, sectionWidth, img.height);\n        \n        const blob = await canvas.convertToBlob({ type: 'image/jpeg', quality: 0.8 });\n        return URL.createObjectURL(blob);\n      });\n\n      const previews = await Promise.all(sectionPromises);\n      setImagePreviews(previews);\n      setIsSplit(true);\n    } catch (err) {\n      console.error('Error splitting image:', err);\n      setError('Failed to split image');\n    } finally {\n      setSplitLoading(false);\n    }\n  };\n\n  const handleSectionClick = (sectionIndex, e) => {\n    const rect = e.target.getBoundingClientRect();\n    const image = e.target;\n    \n    const renderedWidth = image.width;\n    const renderedHeight = image.height;\n    \n    const scaleX = image.naturalWidth / renderedWidth;\n    const scaleY = image.naturalHeight / renderedHeight;\n    \n    const imageAspect = image.naturalWidth / image.naturalHeight;\n    const containerAspect = renderedWidth / renderedHeight;\n    \n    let x = e.clientX - rect.left;\n    let y = e.clientY - rect.top;\n    \n    if (imageAspect > containerAspect) {\n      const actualHeight = renderedWidth / imageAspect;\n      const padding = (renderedHeight - actualHeight) / 2;\n      y = y - padding;\n      y = Math.max(0, Math.min(y, actualHeight));\n    } else {\n      const actualWidth = renderedHeight * imageAspect;\n      const padding = (renderedWidth - actualWidth) / 2;\n      x = x - padding;\n      x = Math.max(0, Math.min(x, actualWidth));\n    }\n    \n    const originalX = Math.round(x * scaleX);\n    const originalY = Math.round(y * scaleY);\n    \n    const sectionWidth = imageSize.width / 3;\n    const adjustedX = originalX + (sectionIndex * sectionWidth);\n    \n    const finalX = Math.max(\n      sectionIndex * sectionWidth,\n      Math.min(adjustedX, (sectionIndex + 1) * sectionWidth - 1)\n    );\n    const finalY = Math.max(0, Math.min(originalY, imageSize.height - 1));\n    \n    const newFocalPoints = [...focalPoints];\n    newFocalPoints[sectionIndex] = { x: finalX, y: finalY };\n    setFocalPoints(newFocalPoints);\n  };\n\n  // >>> UPDATED handleSubmit to call different endpoints based on 'useSecondFrameAsBackground' <<<\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (focalPoints.some(fp => fp === null)) {\n      setError('Please set a focal point on each section before creating wiggle.');\n      return;\n    }\n    setError(null);\n    setLoading(true);\n\n    try {\n      const formData = new FormData();\n      formData.append('image', image);\n      formData.append('focalPoints', JSON.stringify(focalPoints));\n      formData.append('frameSpeed', frameSpeed);\n      formData.append('videoLength', videoLength);\n      formData.append('useSecondFrameAsBackground', useSecondFrameAsBackground.toString());\n\n      // Decide which endpoint to call.\n      // We do /api/process_image_no_rgba if useSecondFrameAsBackground is true,\n      // otherwise /api/process_image.\n      const endpoint = useSecondFrameAsBackground\n        ? 'http://localhost:5000/api/process_image_no_rgba'\n        : 'http://localhost:5000/api/process_image';\n\n      const response = await fetch(endpoint, {\n        method: 'POST',\n        body: formData,\n      });\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error || 'Failed to process image');\n      }\n\n      const blob = await response.blob();\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = 'wiggle.mp4';\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      window.URL.revokeObjectURL(url);\n\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  function handleNext() {\n    setShowWiggleOptions(true);\n  }\n\n  const handleBack = () => {\n    if (showWiggleOptions) {\n      setShowWiggleOptions(false);\n      return;\n    }\n    if (isSplit) {\n      setIsSplit(false);\n    } else if (image) {\n      setImage(null);\n      setFullImagePreview(null);\n      setImagePreviews([]);\n      setFocalPoints([null, null, null]);\n    }\n  };\n\n  const handleRotate180 = async () => {\n    try {\n      if (!loadedImage) {\n        setError('No image loaded.');\n        return;\n      }\n\n      // Perform a 180° rotation by using a canvas exactly the same size\n      const canvas = document.createElement('canvas');\n      canvas.width = loadedImage.width;\n      canvas.height = loadedImage.height;\n\n      const ctx = canvas.getContext('2d');\n\n      // Move the origin to bottom-right, rotate by 180° (Math.PI)\n      ctx.translate(canvas.width, canvas.height);\n      ctx.rotate(Math.PI);\n\n      // Draw the original image at (0,0), which will appear rotated 180°\n      ctx.drawImage(loadedImage, 0, 0);\n\n      ctx.resetTransform();\n\n      // Convert to a Blob, and then a File\n      const blob = await new Promise((resolve, reject) => {\n        canvas.toBlob((b) => {\n          if (!b) return reject(new Error('Canvas is empty, cannot rotate by 180.'));\n          resolve(b);\n        }, 'image/jpeg', 0.9);\n      });\n\n      const rotatedFile = new File([blob], 'rotated_180.jpg', { type: 'image/jpeg' });\n\n      // Create a new Image for preview\n      const rotatedImg = new Image();\n      rotatedImg.onload = () => {\n        setLoadedImage(rotatedImg);\n        setImage(rotatedFile);\n        setFullImagePreview(rotatedImg.src);\n        setImageSize({ width: rotatedImg.width, height: rotatedImg.height });\n        setError(null);\n      };\n      rotatedImg.onerror = () => {\n        setError('Failed to display 180°-rotated image.');\n      };\n      rotatedImg.src = URL.createObjectURL(rotatedFile);\n\n    } catch (err) {\n      console.error('Rotation by 180° failed:', err);\n      setError('Rotation by 180° failed.');\n    }\n  };\n\n  return (\n    <div className=\"container\">\n      {(image || isSplit) && (\n        <button \n          className=\"back-arrow\" \n          onClick={handleBack}\n          title=\"Go back\"\n        >\n          ←\n        </button>\n      )}\n\n      {!image && !isSplit && (\n        <div\n          style={{\n            display: 'flex',\n            width: '100%',\n            justifyContent: 'center',\n            alignItems: 'center',\n            padding: '40px 20px',\n            boxSizing: 'border-box',\n          }}\n        >\n          <div \n            style={{\n              width: '50%',\n              textAlign: 'center',\n            }}\n          >\n            <h1\n              style={{\n                fontSize: '6em',\n                marginBottom: '10px',\n                color: '#5e645a',\n                fontWeight: 'bold',\n                marginTop: '20%'\n              }}\n            >\n              DispoStudio\n            </h1>\n            <h2\n              style={{\n                fontSize: '2.5em',\n                marginBottom: '10px',\n                marginTop: '10px',\n                color: '#5e645a',\n                fontWeight: 'normal',\n              }}\n            >\n              Wiggle Lens Maker\n            </h2>\n            <p\n              style={{\n                lineHeight: '1.5',\n                color: '#5e645a',\n                marginTop: '20%',\n                opacity: '60%',\n                fontSize: '28px',\n                margin: '20% 20%'\n              }}\n            >\n              Easily create wiggle lens effect videos with your \n              <a \n                href=\"https://www.etsy.com/uk/shop/DispoStudio\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                style={{ color: '#5e645a', textDecoration: 'underline', marginLeft: '5px', marginRight: '5px' }}\n              >\n                Swiss Army Lens\n              </a> \n              photos in just a few clicks.\n            </p>\n          </div>\n\n          <div style={{ width: '50%' }}>\n            <div className=\"upload-container\" style={{ textAlign: 'center' }}>\n              <label className=\"upload-label\">\n                <input \n                  type=\"file\" \n                  accept=\"image/*\" \n                  onChange={handleImageUpload}\n                  required \n                  className=\"upload-input\"\n                />\n                Upload Image\n              </label>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {!showWiggleOptions && (\n        <form onSubmit={handleSubmit} className=\"upload-form\">\n          {fullImagePreview && !isSplit && (\n            <div className=\"full-image-container\" style={{ display: 'flex', gap: '20px' }}>\n              <img \n                src={fullImagePreview} \n                alt=\"Full uploaded image\" \n                className=\"full-image\"\n              />\n              <div\n                style={{\n                  display: 'flex',\n                  flexDirection: 'row',\n                  alignItems: 'center',\n                  justifyContent: 'space-between',\n                  width: '90%',\n                  margin: '0 auto',\n                }}\n              >\n                <button \n                  type=\"button\"\n                  onClick={handleRotate180}\n                  className=\"rotate-button\"\n                  style={{\n                    width: '45%',\n                    textAlign: 'center',\n                    backgroundColor: '#5e645a',\n                  }}\n                >\n                  Rotate 180°\n                </button>\n\n                <button \n                  type=\"button\"\n                  onClick={handleSplitImage}\n                  className=\"split-button\"\n                  disabled={splitLoading}\n                  style={{\n                    width: '45%',\n                    textAlign: 'center',\n                    backgroundColor: '#5e645a',\n                  }}\n                >\n                  {splitLoading ? 'Splitting...' : 'Split Image'}\n                </button>\n              </div>\n            </div>\n          )}\n\n          {isSplit && imagePreviews.length > 0 && (\n            <>\n              <div className=\"sections-container\">\n                {imagePreviews.map((preview, index) => (\n                  <div key={index} className=\"section-card\">\n                    <div className=\"section-image-container\">\n                      <img\n                        src={preview}\n                        alt={`Section ${index + 1}`}\n                        onClick={(e) => handleSectionClick(index, e)}\n                        className=\"section-image\"\n                      />\n                      {focalPoints[index] && (\n                        <div\n                          className=\"focal-marker\"\n                          style={{\n                            left: `${(\n                              (focalPoints[index].x - index * (imageSize.width / 3)) \n                              / (imageSize.width / 3)\n                            ) * 100}%`,\n                            top: `${(focalPoints[index].y / imageSize.height) * 100}%`,\n                          }}\n                        />\n                      )}\n                    </div>\n                    {focalPoints[index] && (\n                      <div className=\"coordinates-text\">\n                        {`Focal point: (${Math.round(focalPoints[index].x - index * (imageSize.width / 3))}, ${Math.round(focalPoints[index].y)})`}\n                      </div>\n                    )}\n                  </div>\n                ))}\n              </div>\n              {focalPoints.some(fp => fp === null) && (\n                <h3 className=\"previews-title\">Click on each section to set focal points:</h3>\n              )}\n            </>\n          )}\n\n          {isSplit && !focalPoints.some(fp => fp === null) && (\n            <button\n              type=\"button\"\n              className=\"submit-button\"\n              onClick={handleNext}\n            >\n              Next\n            </button>\n          )}\n        </form>\n      )}\n\n      {showWiggleOptions && (\n        <form onSubmit={handleSubmit} className=\"upload-form\" style={{ marginTop: '5%', textAlign: 'center' }}>\n          <div style={{ marginBottom: '40px', marginTop: '40px', textAlign: 'center', width: '100%' }}>\n            <button\n              type=\"button\"\n              disabled\n              className=\"split-button\"\n              style={{\n                backgroundColor: '#5e645a',\n                cursor: 'default',\n                marginBottom: '20px',\n                margin: '0 2%',\n                width: '25%'\n              }}\n            >\n              Frame Speed:\n            </button>\n\n            <div style={{ display: 'inline-block', margin: '0 2%', textAlign: 'center', width: '20%' }}>\n              <h3 style={{ margin: '0 0 5px 0', color: '#5e645a' }}>0.1s</h3>\n              <button\n                type=\"button\"\n                className={`frame-button ${frameSpeed === 0.1 ? 'selected-frame' : ''}`}\n                onClick={() => setFrameSpeed(0.1)}\n              >\n                Fast\n              </button>\n            </div>\n\n            <div style={{ display: 'inline-block', margin: '0 1%', textAlign: 'center', width: '20%' }}>\n              <h3 style={{ margin: '0 0 5px 0', color: '#5e645a' }}>0.2s</h3>\n              <button\n                type=\"button\"\n                className={`frame-button ${frameSpeed === 0.2 ? 'selected-frame' : ''}`}\n                onClick={() => setFrameSpeed(0.2)}\n              >\n                Medium\n              </button>\n            </div>\n\n            <div style={{ display: 'inline-block', margin: '0 1%', textAlign: 'center', width: '20%' }}>\n              <h3 style={{ margin: '0 0 5px 0', color: '#5e645a' }}>0.3s</h3>\n              <button\n                type=\"button\"\n                className={`frame-button ${frameSpeed === 0.3 ? 'selected-frame' : ''}`}\n                onClick={() => setFrameSpeed(0.3)}\n              >\n                Slow\n              </button>\n            </div>\n          </div>\n\n          <div style={{ marginBottom: '40px', marginTop: '40px', textAlign: 'center', width: '100%' }}>\n            <button\n              type=\"button\"\n              disabled\n              className=\"split-button\"\n              style={{\n                backgroundColor: '#5e645a',\n                cursor: 'default',\n                marginBottom: '20px',\n                margin: '0 2%',\n                width: '30%',\n              }}\n            >\n              Video Length: {parseFloat(videoLength).toPrecision(2)}s\n            </button>\n            <input\n              type=\"range\"\n              min=\"1\"\n              max=\"10\"\n              value={videoLength}\n              onChange={(e) => setVideoLength(parseFloat(e.target.value))}\n              step={(3 * frameSpeed).toPrecision(1)}\n              className=\"video-slider\"\n              defaultValue={5}\n            />\n          </div>\n\n          <div style={{ margin: '30px 0', textAlign: 'center', width: \"100%\" }}>\n            <button\n              type=\"button\"\n              disabled\n              className=\"split-button\"\n              style={{\n                backgroundColor: '#5e645a',\n                cursor: 'default',\n                margin: '0 3%',\n                width: '50%',\n              }}\n            >\n              Cover background with frame 2:\n            </button>\n            \n            {/* Yes button */}\n            <button\n              type=\"button\"\n              className={`split-button ${useSecondFrameAsBackground ? 'selected-frame' : ''}`}\n              style={{ marginRight: '2%', width: '20%' }}\n              onClick={() => setUseSecondFrameAsBackground(true)}\n            >\n              Yes\n            </button>\n            \n            {/* No button */}\n            <button\n              type=\"button\"\n              className={`split-button ${!useSecondFrameAsBackground ? 'selected-frame' : ''}`}\n              style={{ marginRight: '2%', width: '20%' }}\n              onClick={() => setUseSecondFrameAsBackground(false)}\n            >\n              No\n            </button>\n          </div>\n\n          <button\n            type=\"submit\"\n            className=\"submit-button split-button\"\n            style={{ marginRight: '2%', width: '80%', textAlign: \"center\", marginTop: \"20%\" }}\n          >\n            {loading ? processingText : 'Export Video'}\n          </button>\n        </form>\n      )}\n\n      {error && (\n        <div className=\"error-message\">\n          Error: {error}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}